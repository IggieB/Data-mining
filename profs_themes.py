# FILE: profs_themes.py.py
# WRITER:lee matan,leem72,207378803
# EXERCISE:intro2cse final_project_rap 2020
# DESCRIPTION:
# NOTES:

# Themes dict creation
ass = "anal, analanni, analsex, anu, ars, arsehol, ass, assbagg, assblast, assclown, asscowboy, assfuck, asshat, asshol, asshor, assjockey, asskiss, assklown, asslick, asslov, assman, assmonkey, assmunch, asspack, asspir, asspuppi, assrang, asswhor, asswip, butt, buttbang, buttfac, buttfuck, butthead, buttman, buttmunch, buttpir, buttplug, buttstain, buttfac, rimjob, suckmyass, bigass, fatass, dumbass, intheass, jackass, kissass, bigbutt, upthebutt, uptheass, booti, bootycal, rim, bunga, bunghol, cornhol, rearend, rearentri, boodi, glazeddonut, enema, bugger, buggeri"
feecees = "shitfuck, shitdick, bullshit, dipshit, horseshit, jackshit, shhit, shit, shitcan, shite, shiteat, shitfac, shitfit, shitforbrain, shitful, shithapen, shithappen, shithead, shithous, shitlist, shitola, shitoutofluck, shitstain, shitter, shitti, pee, peehol, peepe, piss, pisser, pisshead, pissin, pissoff, poop, pooper, pooperscoop, turd, crap, crapola, crapper, crappi, pi55, barfac, barffac, barf, krap, krappi, goldenshow, doodoo, bullcrap, farti, phuke, tinkle, dingleberri, poo, scat, shat, whiz"
sex = "anal, analanni, analsex, anu, assfuck, backdoorman, buttbang, buttfuck, buttplug, sex, sexfarm, sexhound, sexhous, sexkitten, sexpot, sexslav, sextogo, sextoy, sexwhor, sexi, sexymoma, sexyslim, badfuck, bumblefuck, bumfuck, buttfac, dumbfuck, facefuck, cuntfuck, cuntlick, cuntsuck, fannyfuck, fastfuck, fatfuck, fingerfuck, fistfuck, footfuck, freakfuck, freakyfuck, freefuck, fuc, fucck, fuck, fucka, fuckabl, fuckbag, fuckbuddi, fuckedup, fucker, fuckfac, fuckfest, fuckfreak, fuckfriend, fuckhead, fuckher, fuckin, fuckina, fuckingbitch, fuckinnut, fuckinright, fuckit, fuckknob, fuckm, fuckmehard, fuckmonkey, fuckoff, fuckpig, fucktard, fuckwhor, fuckyou, fuk, funfuck, fuuck, gangbang, gaymuthafuckinwhor, goddamnmuthafuck, barfac, barffac, headfuck, mothafuck, mothafucka, mothafuckaz, mothafuckin, motherfuck, motherfuckin, nofuckingway, nutfuck, pussyfuck, rentafuck, shitfuck, shortfuck, skankfuck, stupidfuck, titfuck, titfuckin, unfuck, whorefuck, blowjob, breastjob, handjob, hosejob, lubejob, rimjob, titjob, dicklick, suckmydick, suckdick, cocklick, cocklov, cocksuc, cocksuck, cockteas, pussyeat, pussylick, pussylov, pussypound, eatpussi, breastlov, titlick, titlov, balllick, intheass, shitfac, bang, doggiestyl, doggystyl, deapthroat, deepthroat, fu, fubar, porn, pornflick, pornk, porno, pornprincess, pimp, pimper, pimpjuic, pimpsimp, popimp, shawtypimp, xxx, triplex, bootycal, brothel, virginbreak, sixtynin, spigotti, footact, footlick, forni, fornic, fckcum, felatio, felch, felcher, fellatio, feltch, feltcher, cuck, givehead, orgi, horney, horniest, horni, noonan, nooner, phuq, fok, mattressprincess, phuk, quicki, ero, threeway, tongethrust, tonguethrust, wetback, wetspot, glazeddonut, enema, inthebuff, gummer, clamdigg, gonorrehea, hottotrot, iblowu, spreadeagle, chickslick, Juggalo, fugli, peepshow, peepshpw, lapdanc, scat, rump, shag, shaggin, slideitin, tuckahoe, mofo, playboy, playgirl, suckm, suckoff, swallow, turnon, snowback, dildo, taff, coitu, clamdiv, bugger, buggeri, crotchjockey, hodgi, licker, Lolita, hustler, wtf, uck, uk, spank"
dick = "dick, dickbrain, dickforbrain, dickhead, dickless, dicklick, dickman, dickwad, dickwe, suckmydick, dripdick, limpdick, shitdick, suckdick, pindick, whiskeydick, whiskydick, cock, cockblock, cockcowboy, cockfight, cockhead, cockknob, cocklick, cocklov, cocknob, cockqueen, cockrid, cocksman, cocksmith, cocksmok, cocksuc, cocksuck, cockteas, hiscock, balllick, ball, ballsack, spermbag, boner, meatsack, kock, dix, dong, lovebon, lovegun, lovemuscl, lovepistol, loverocket, pecker, pud, pudboy, pudd, puddboy, erect, thirdleg, mosshead, manpast, choad, chode, hardon, dipstick, schlong, scrotum, nudger, skinflut, munt, eatbal"
pussy = "pussycat, pussyeat, pussylick, pussylip, pussylov, pussypound, puss, pussi, pusi, eatpussi, hotpussi, clit, cunntt, cunt, cuntfuck, cuntlick, cuntsuck, pu55i, pussyfuck, kunt, camelto, poontang, luckycammelto, nook, nookey, nooki, muff, muffdiv, muffindiv, mufflikc, cherrypopp, crotchrot, flang, poon, queef, fingerfood, puntang, quim, tang, vulva"
breasts = "breastjob, breastlov, breastman, breastjob, tit, titbitnippli, titlick, titlov, titti, nittit, suckmytit, titfuck, titfuckin, titjob, boob, boobi, hooter, bazonga, bazoom, honk, honker, honkey, honki, knocker, gonzaga, teat, jug"
black = "datnigga, nig, niger, Nigerian, nigg, nigga, niggah, niggaracci, niggard, niggardli, niggaz, nigger, niggerhead, niggerhol, niggl, niggor, niggur, niglet, nignog, nigr, nigra, nip, nlgger, nlggor, sandnigg, snigger, snownigg, spaghettinigg, timbernigg, whitenigg, negro, negroid, darki, kaffer, kaffir, kaffr, kafir, picaninni, piccaninni, pickaninni, jigaboo, jiga, jigga, jiggabo, alligatorbait, thicklip, coon, coondog, koon, gatorbait, jijjiboo, mooncricket, junglebunni, porchmonkey, macaca, jimfish, kkk, mulatto, tarbabi, zigabo"
mysogynistic = "bitch, bitcher, bitchez, bitchin, bitchslap, bitchi, dumbbitch, nastybitch, skank, skankbitch, skankwhor, skanki, skankybitch, skankywhor, cuntey, cunt, biatch, crackwhor, nastyho, nastyslut, nastywhor, slut, slutt, slutti, slutwear, slutwhor, whore, whorehous, twobitwhor, easyslut, asswhor, sexwhor, fuckwhor, gaymuthafuckinwhor, whorefuck, sonofabitch, sonofbitch, fuckingbitch, kunt, byatch, milf, hooker, hore, tramp, thot, pornprincess, henhouse, ho, hoe, mattressprincess, hussi, holestuff, ontherag, booni, randi, splittail"
lgbt_phobic = "gay, gaymuthafuckinwhor, fag, faggot, fagot, homo, homobang, tranni, transexu, transsexu, transvestit, sodomis, sodomit, Sodom, sodomi, queer, lesbo, lez, lezb, lezbefriend, lezbo, lezz, lezzo, sissi, twink, twinki, butchbab, butchdik, butchdyk, fudgepack, dyke, bulldik, bulldyk, muncher"
masturbation = "jackoff, meatbeatt, jerkoff, wank, wanker, williewank, mastab, mastabat, masterb, masterblast, mastrab, masturb, beatoff, beatyourmeat, pocketpool, spankthemonkey, smackthemonkey, diddl"
sperm = "cum, cumbubbl, cumfest, cumjockey, cumm, cummer, cumquat, cumqueen, cumshot, cunn, spermacid, spermbag, spermheard, spermherd, jism, jiz, jizim, jizjuic, jizm, jizz, jizzim, jizzum, semen, geez, geezer, jeez, pimpjuic, kum, lovegoo, lovejuic, spunk, spunki, spoog, kummer"
general = "idiot, stupid, sucker, moron, dumb, bastard, bigbastard, dammit, damn, damnit, godammit, goddamit, goddammit, goddamn, goddamnit, mad, tard, bollick, bollock, kumquat, hotdamn, skumbag, sleezebag, sleezebal, jesu, jesuschrist, loser, scallywag, boang, hell, pric, prick, prickhead, Dahmer, gotohel, looser, screwyou, welcher, retard, twat, scum, gipp, rere, skum, whacker, dink, quashi, lowlif"
anti_asian = "chinaman, chinamen, jap, japcrap, yellowman, slant, slantey, paki, hindoo, kotex, slopehead, kigger, honger, zipperhea, phungki, raghead, gook, hapa"
antisemitic = "jew, kike, kyke, goy, goyim, hebe, heeb, jigger, mockey, mocki, cohe"
islamophobic = "cameljockey, carpetmunch, moslem, palesimian, towelhead, raghead"
anti_white = "poorwhitetrash, whitetrash, whitey, hillbilli, redneck, peckerwood, gringo, pohm, pom, pommi, limey, limi, kraut, clogwog, greaseball, trailertrash, dago, dego, wigger, gubba, ginzo, polack, lugan, roundey, russki, seppo, payo, whigger, spaghettibend, whop, wop, whash"
drugs = "reefer, bong, fourtwenti, smack, stringer"
anti_latin = "spic, spick, spig, spik, mgger, mggor, beaner, pocha, pocho, wab"
anti_roma = "gyp, gypo, gypp, gyppi, gyppo"
anti_native = "abbo, abo, boong, boonga, squaw"

# UNITED CATEGORIES
CONNECT = ", "
dick_and_sperm = dick + CONNECT + sperm
pussy_and_breasts = pussy + CONNECT + breasts

categories_dict = {"ass related": ass,
                   "feecees related": feecees,
                   "sex related": sex,
                   "dick related": dick,
                   "pussy related": pussy,
                   "breasts related": breasts,
                   "black related": black,
                   "mysogynistic": mysogynistic,
                   "LGBT": lgbt_phobic,
                   "masturbation": masturbation,
                   "sperm": sperm,
                   "anti asian": anti_asian,
                   "antisemitic": antisemitic,
                   "islamophobic": islamophobic,
                   "anti white": anti_white,
                   "drugs related": drugs,
                   "anti latin": anti_latin,
                   "anti roma": anti_roma,
                   "anti native": anti_native}


def get_n_longest_values_g(dictionary, n):
    longest_entries = sorted(
        dictionary.items(), key=lambda t: len(t[1]), reverse=True)[:n]
    return [(key, len(value)) for key, value in longest_entries]


def create_valid_themes_dict(dict):
    new_dict = {}
    for key, val in dict.items():
        new_dict[key] = val.split(", ")
    return new_dict


def create_top_n_themes_dict(dict, n):
    valid_dict = create_valid_themes_dict(dict)
    dict_top_n = get_n_longest_values_g(valid_dict, n)
    valid_top_ten_dict = {}
    for item in dict_top_n:
        key = item[0]
        valid_top_ten_dict[key] = valid_dict[key]
    return valid_top_ten_dict

# pies backup for themes diversions, the function before it has been converted
# to analyze also the full data
# graph 13, 4, 5
def full_profs_diversion_by_theme(json_files, prof_categories):
    """
    A function that shows the profanities' themes' diversion in one group
    of artists' songs.
    :param group_name: A string for the group of artists.
    :param json_files: A list of json files names (strings)
    :param category: The string representing the field of which we want to
    explore one group. (e.g. "Gender" or "Ethnicity")
    :param group: The group representative names (["Female"] or ["British",
    "French"]
    :param prof_categories: A dictionary of categories shown as
    key=theme name string, value=theme words list.
    :return: a dictionary of the key, value = theme, percentage.
    """
    themes_diversion_dict = {}
    for one_json in json_files:
        one_file_diversion = ingroup_profs_diversion_counts(one_json, category,
                                                            group,
                                                            prof_categories)
        for cat, count in one_file_diversion.items():
            if cat in themes_diversion_dict:
                themes_diversion_dict[cat] += count
            else:
                themes_diversion_dict[cat] = count
    total_prof_shows = sum(themes_diversion_dict.values())
    for category_name, count in themes_diversion_dict.items():
        themes_diversion_dict[category_name] = (count / total_prof_shows)\
                                                    * 100
    # sort the dictionary for the pie legend to be ordered from most popular to
    # least.
    sorted_themes_diversion = {key: value for key, value in
                               sorted(themes_diversion_dict.items(),
                                      key=lambda kv: kv[1], reverse=True)}
    # pie chart
    plt.style.use("fivethirtyeight")
    categories = list(sorted_themes_diversion.keys())  # profs themes
    fraction = list(sorted_themes_diversion.values())  # theme percentage
    labels = [f'{s:0.1f}% {l}' for l, s in zip(categories, fraction)]
    explode = [0.01 for i in range(len(labels))]
    colors_list = ["#B91D2D", "#F5921D", "#27317E", "#28AAE1", "#B5D4EF",
                   "#006838", "#39B54A", "#F9ED32", "#68499E", "#BA89F9",
                   "#949597"]
    plt.axis("equal")
    plt.pie(fraction, explode=explode, colors=colors_list)

    # draw circle
    centre_circle = plt.Circle((0, 0), 0.70, fc='white')
    fig = plt.gcf()
    fig.gca().add_artist(centre_circle)

    # Equal aspect ratio ensures that pie is drawn as a circle
    plt.tight_layout()

    plt.legend(labels=labels, loc="center")
    plt.title(f"Profanities Themes Diversion:\nAll Artists All Times", pad=-30)
    plt.show()
    return sorted_themes_diversion




if __name__ == '__main__':
    d = create_top_n_themes_dict(categories_dict, 10)
    print(d)
    # for key, val in d.items():
    #     print(f"{key}: {val}\n")
